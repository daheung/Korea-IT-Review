day20(dbms 2일차)
복습 -> 연산자2 -> 쿼리문의 종류 -> DDL -> 제약조건

0. 복습
1) 데이터베이스(DB)
   여러 데이터를 모아둔 저장소
   
2) 데이터베이스 관리 시스템(DBMS)
   DB를 관리하는 시스템
   ex) Oracle, MySQL/MariaDB, MongoDB

- DB 특징
   데이터 일관성
   데이터 독립성
   동시접속
   데이터 공유

3) RDBMS 구조
   테이블 = 기본단위
   Row   = tuple / record / instance
   Column   = field / attribute

4) SQL
   DB 조작하는 언어
   한 줄씩 실행
   대소문자 구분하지 않음
   ; 필수
   줄바꿈 자유

5) 오라클 기본 계정
   sys   최고 관리자
   system   운영관리
   hr   학습용(연습용)

6) 스크립트 파일(.sql)
   SQL 여러개 저장 파일
   
7) SELECT문(조회)
   SELECT [DISTINCT] 컬럼명 [AS 별칭]
   FROM 테이블명
   [WHERE 행 필터링] -- 관계연산자/논리연산자
   [ORDER BY 정렬기준컬럼명 [ASC/DESC]];

8) 자료형
   문자   CHAR      고정길이
      VARCHAR2   가변길이
   숫자   NUMBER(p)   전체자리수
      NUMBER(p, s)   전체자리. 소수자리
   날짜   DATE      날짜+시간
      TIMESTEMP   밀리초
      
1. 연산자
   피연산자 자리에 어떤 타입의 값이 오는지
   연산자가 어떻게 동작하는지
   연산의 결과가 어떤 타입의 값인지

1) 연결 연산자
   'a'||'b'   => 문자열 합치기
   1 || 2      => 피연산자 : 숫자, 연산결과 : 문자
   
2) 산술 연산자
   +   =   *   /
   피연산자의 타입이 숫자와 숫자면 => 연산자 모두 사용 가능, 결과는 숫자타입
   피연산자의 타입이 날짜와 날짜면 => 연산자 -      결과는 숫자타입 
   피연산자의 타입이 날짜와 숫자면 => 연산자 +, -   결과는 날짜타입

3) 관계 연산자
   >   <   >=   <=   =   != <>

4) 논리 연산자
   AND   OR   NOT

[실습]
1. 급여가 5000이상이고 직무ID가 SA_MAN인 직원 조회
   직원의 이름과 성은 이름이라는 별칭으로 연결해서 출력하되 급여 기준으로 오름차순 정렬되도록

- 조건1 : 급여(salary) >= 5000
- 조건2 :   직무ID(job_id) = 'SA_MAN'
- AND 연산자 사용

- FROM -> WHERE -> SELECT -> ORDER BY
SELECT first_name || ' ' || last_name 이름, salary 급여, job_id 직무ID
FROM employees
WHERE salary >= 5000 AND job_id = 'SA_MAN'
ORDER BY salary;

-- 2. 부서ID가 60이거나 급여가 4000이하인 직원 조회
---   직원의 이름, 전화번호, 입사일 출력하되 입사일 기준으로 내림차순 정렬되도록
-- 조건1 : 부서ID(department_id) = 60
-- 조건2 : 급여(salary) <= 4000
-- OR 연산자 사용
SELECT first_name || ' ' || last_name 이름, phone_number 전화번호, hire_date 입사일
FROM employees
WHERE department_id = 60 OR salary <= 4000
ORDER BY 입사일 DESC;


-- 3. MANAGER_ID가 존재하지 않는 직원들을 조회
--   직원의 이름과 성은 직원명이라는 별칭으로 연결하여 출력
-- 조건1 : MANAGER_ID is NULL;
SELECT first_name || ' ' || last_name 직원명
FROM employees
WHERE manager_id is NULL;

5) SQL 연산자
   SQL에서만 존재하는 연산자
   
- IS NULL / IS NOT NULL      데이터의 NULL 여부를 판단하기 위해 사용한다
      NULL      데이터가 존재하지 않음을 나타내는 값
      IS NULL      값이 NULL 일 경우
      IS NOT NULL   값이 NULL이 아닌경우

- UNKNOWN   결과를 알 수 없음, 조회할 수 없음
      NULL 값과 조건(관계연산자 등)을 사용하거나 NULL 값 결과와 함께 사용할 경우 UNKNOWN

   SQL 조건 결과는 3가지로 나온다
   TRUE   참
   FALSE   거짓
   UNKNOWN   모름

   a = NULL   => UNKNOWN으로 평가되므로 조건을 만족하는 행이 없어서 결과가 출력되지 않는다
   a != NULL   => UNKNOWN으로 평가되므로 조건을 만족하는 행이 없어서 결과가 출력되지 않는다

   - 오라클은 길이가 0인 문자값을 NULL로 처리한다

- BETWEEN A AND B   A 이상 B 이하인 조건을 만족하면 TRUE
      BETWEEN 숫자a AND 숫자b   숫자a 이상 숫자b 이하인 조건이면 TRUE
      BETWEEN 날짜a AND 날짜n   시작날짜 a부터 종료날짜 b사이의 날짜이면 TRUE

   - A와 B 사이에는 대소 관계 비교가 진행되기 때문에 BETWEEN 작은 값 AND 큰 값으로 사용해야한다
   - 날짜로 사용시에는 BETWEEN 예전날짜 AND 최근날짜로 사용해야한다

- IN(a, b, c, ..)   a 또는 b 또는 c인 조건을 만족하면 true

- LIKE      문자열의 패턴을 검색하기 위해 사용한다
   %   어떤 문자를 포함한 모든 문자
   _   단일 문자(문자의 길이 지정)
   
   a%   a로 시작하는 모든 문자
   %a   a로 끝나는 모든 문자
   %a%   중간에 a가 들어가는 모든 문자

6) NULL과 관련된 함수 => 테이블 생성 후 쿼리문 확인
- NULL이면 특정 값으로 변경
   NVL(컬럼명, 기본값) : 해당 컬럼의 값이 NULL이면 지정한 기본값으로 출력
   NVL2(컬럼명, NULL이 아니면 사용할 값, NULL이면 사용할 값2) : NULL이 아니면 값1, NULL이면 값2 출력

- 특정 값이면 NULL로 변경
   NULLIF(컬럼명, 값1) : 컬럼의 값이 값1과 같으면 NULL로 변환, 값1과 같지 않다면 컬럼의 값
   NULLIF(컬럼명1, 컬럼명2) : 컬럼1과 컬럼2의 값이 일치하면 NULL로 변환, 아니라면 컬럼1의 값

- 여러 값 중 첫번째 값
   COALLESCE(값1, 값2, 값3) : 여러 값 중 NULL이 아닌 첫번째 선택
   

2. 쿼리문(SQL문)의 종류 ★★★★★
   SQL 명령어의 성격에 따라 분류한 것이다

   DDL(Data Definition Language) : 데이터 정의 언어(데이터정의어)
      데이터 구조(테이블 정의)를 만들고 바꾸는 명령어
   DML(Data Manipulation Language) : 데이터 조작 언어(데이터 조작어)
   DCL(Data Control Language)   : 데이터 제어 언어(데이터 제어어)
      권한 부여, 권한 회수   
   TCL(Transaction Control Language) : 트랜잭션 제어어
      트랜잭션 제어(DML의 변경 내용을 확정/취소)

1) DML : 데이터 조작어
- SELECT : 조회
   SELECT [DISTINCT] 컬럼명 [AS 별칭]
   FROM 테이블명
   [WHERE 조건식]
   [ORDER BY 기준컬럼 ASC or DECS];

- INSERT : 추가
   원하는 컬럼만 골라서 값을 저장할 때 사용
   INSERT INTO 테이블명(컬럼명1, 컬럼명2)
   VALUES (값1, 값2);

   전체 컬럼에 값을 저장할 때 사용
   INSERT INTO 테이블명
   VALUES (값1, 값2);

- UPDATE : 수정
   UPDATE 테이블명
   SET 컬럼명1 = 값1
   [WHERE 조건식];

- DELETE : 삭제
   DELETE FROM 테이블명
   [WHERE 조건식];

2) DDL : 데이터 정의어
- CREATE : 테이블생성, 유저생성, 시퀀스생성, 뷰생성
   CREATE TABLE 테이블명(
      컬럼명1 자료형(용량) [제약조건],
      컬럼명2 자료형(용량),
      [제약조건]
   );

- DROP : 테이블 삭제
   DROP TABLE 테이블명;

- ALTER : 테이블 수정
   ALTER TABLE 테이블명
   -- 테이블명 수정 RENAME TO 새로운 테이블명;
   -- 컬럼명 수정 RENAME COLUMN 기존 컬럼명 TO 변경할 컬럼명;
   -- 컬럼 타입 수정 MODIFY(기존컬럼명 자료형(용량));
   -- 컬럼 추가   ADD(새로운컬럼명 자료형(용량));
   -- 컬럼 삭제   DROP COLUMN 기존컬럼명;
   -- 제약조건 추가   ADD CONSTRAINT 제약조건이름 제약조건(현재 테이블의 컬럼명);
         ADD CONSTRAINT 제약조건이름 FOREIGN KEY(현재테이블의컬럼명) REFERENCES 상위테이블명(컬럼명);
   -- 제약조건 삭제   DROP CONSTRAINT 제약조건이름;


- TRUNCATE : 테이블 내용 전체 삭제(테이블이 아닌 데이터 삭제!!!)
   TRUNCATE TABLE 테이블명;

+) DELETE와 TRUNCATE 차이
   DELETE : DML, 테이블의 모든 데이터 삭제, 테이블의 전체 용량은 감소하지 않음, Rollback 가능, where절 사용가능
   TRUNCATE : DDL, 테이블의 모든 데이터 삭제, 테이블의 전체 용량 초기화, Rollback 불가능, where절 사용불가능
